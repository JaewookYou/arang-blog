---
title: "2020 사이버작전 경연대회 - Intranet Writeup"
description: "Nginx route 설정 오류와 NoSQL Injection, Race Condition을 이용한 권한 상승"
date: 2020-11-20
tags: ["cyber-warfare", "nosql-injection", "race-condition", "nginx"]
ctf: "사이버작전 경연대회 2020"
published: true
---

# 2020 사이버 작전 경연대회 [웹] - Intranet Write-up

## 문제 정보

| 문 제 | 분 야 | 점 수 |
|------|------|------|
| 1.3 Intranet | WEB | ? |

> 노출된 적국의 생화학 연구소 내부 사이트에서, 관리자 권한을 탈취하여 내부 시스템을 탐색하라.

---

## 풀이 절차

1. **Nginx route 설정 오류**를 이용한 server source code leak
2. **NoSQL injection**으로 member 권한 획득
3. 기능 확인 후 **Race condition**을 이용하여 admin 권한 획득
4. 게시판의 member level=2 게시글 조회 시 플래그 획득

---

## 취약점

### Nginx Route 설정 오류

```
/app/../source_code_path
```

Nginx 설정 오류로 소스코드 leak 가능

### NoSQL Injection

```
{"$ne": ""}
```

NoSQL Injection으로 인증 우회

### Race Condition

member 권한 체크와 admin 권한 부여 사이에 race condition 존재

---

## Flag

```
flag{This_is_top_secret_dont_you_agree}
```
