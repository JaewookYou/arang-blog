---
title: "2019 hack.lu CTF - RPDG Writeup"
description: "SQL Injectionê³¼ ë¹ˆë„ìˆ˜ ë¶„ì„ì„ í†µí•œ admin password ìœ ì¶”"
date: 2019-10-25
tags: ["hacklu", "sql-injection", "misc", "frequency-analysis"]
ctf: "hack.lu CTF 2019"
published: true
---

# [Write-up] 2019 hack.lu CTF [WEB+MISC] - "RPDG"


## ğŸ“¸ ì›ë³¸ ì´ë¯¸ì§€

![Image 1](/images/writeups/hacklu-2019-rpdg_895b05e1.png)

![Image 2](/images/writeups/hacklu-2019-rpdg_9aa85583.png)

![Image 3](/images/writeups/hacklu-2019-rpdg_2588330c.png)

![Image 4](/images/writeups/hacklu-2019-rpdg_e20ecb5c.png)


## Summary

í•´ë‹¹ ë¬¸ì œëŠ” **WEB + MISC** ë³µí•© ë¬¸ì œì…ë‹ˆë‹¤.

- **Stage 1:** ì›¹ (SQL Injection)
- **Stage 2:** MISC (ë¹ˆë„ìˆ˜ ë¶„ì„)

ê¸°ë³¸ì ìœ¼ë¡œëŠ” SQL injectionì„ í†µí•´ ì •ë³´ë¥¼ íšë“í•˜ê³ , ì´í›„ ë¹ˆë„ìˆ˜ì— ë”°ë¼ admin passwordë¥¼ ìœ ì¶”í•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤.

---

## Vulnerability

ë¬¸ì œ í˜ì´ì§€ë¥¼ ë³´ë©´ ìœ íŠœë¸Œ ì˜ìƒë“¤ì´ ìˆê³  í•´ë‹¹ ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ë¥¼ í´ë¦­í•  ì‹œ:

```
/open.php?title={Base64 encoded movie name}
```

ë¥¼ í†µí•´ ìœ íŠœë¸Œë¡œ ì´ë™í•˜ê²Œ ë©ë‹ˆë‹¤.

ë„˜ê¸°ëŠ” title íŒŒë¼ë¯¸í„°ë¥¼ base64 decode í•´ë³¼ ì‹œ link ì£¼ì†Œê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— **ë‚´ë¶€ ë°ì´í„°ë² ì´ìŠ¤ì— ì •ë³´ê°€ ë§¤í•‘**ë˜ì–´ ìˆê³ , í•´ë‹¹ íŒŒë¼ë¯¸í„°ì˜ ì •ë³´ê°€ DBë¡œ ë“¤ì–´ê°ˆ ê²ƒì„ ìœ ì¶”í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## SQL Injection

### DB Schema ì¶”ì¶œ

```
schema: rpdg
table: culture, tracking
column culture: id, link, title, year
column tracking: id, key, path, timestamp, user
```

### ë°ì´í„° ì¶”ì¶œ

tracking í…Œì´ë¸”ì—ì„œ adminì˜ key(password) ì •ë³´ ì¶”ì¶œ

---

## MISC - ë¹ˆë„ìˆ˜ ë¶„ì„

ì¶”ì¶œí•œ ë°ì´í„°ë¥¼ ë¹ˆë„ìˆ˜ ë¶„ì„í•˜ì—¬ admin password ë³µì›
