---
title: "2020 TSG CTF - Slick Logger Writeup"
description: "Time-based Blind Regex Injection으로 플래그 탈취"
date: 2020-07-12
tags: ["tsg-ctf", "regex-injection", "blind", "golang"]
ctf: "TSG CTF 2020"
published: true
---

# [Web] 2020 TSG CTF - Slick Logger Writeup

## Time Based Blind Regex Injection

**5 solvers**

---

## 취약점

Go 언어 기반 웹서버에서 사용자 입력이 regex 패턴에 사용됨

```go
func searchHandler(w http.ResponseWriter, r *http.Request) {
    channelID, ok := r.URL.Query()["channel"]
    if !ok || !validateParameter(channelID[0]) {
        http.Error(w, "channel parameter is required", 400)
        return
    }
    
    queries, ok := r.URL.Query()["q"]
    if !ok || !validateParameter(queries[0]) {
        http.Error(w, "q parameter is required", 400)
        return
    }
    
    users := []User{}
    readJSON("/v...")
    // regex matching with user input
}
```

---

## Exploit 방법

### Regex DoS를 이용한 시간 기반 블라인드

특정 regex 패턴이 매칭될 때 처리 시간이 길어지는 것을 이용

```
(a{1,100})*b   vs   (a{1,100})*c
```

플래그 문자열이 포함되어 있으면 processing time이 증가하는 원리를 이용하여 한 글자씩 추출

---

## 결론

Time-based blind regex injection이라는 새로운 기법을 활용한 문제였다.
