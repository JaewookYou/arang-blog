---
title: "2020 사이버작전 경연대회 - Vaccine Paper Writeup"
description: "CSP를 이용한 XS-Leak 공격으로 관리자 키 탈취"
date: 2020-11-20
tags: ["cyber-warfare", "xs-leak", "csp", "font-face"]
ctf: "사이버작전 경연대회 2020"
published: true
---

# 2020 사이버 작전 경연대회 [웹] - Vaccine Paper Write-up

## 문제 정보

| 문 제 | 분 야 | 점 수 |
|------|------|------|
| 2.2 Vaccine Paper | WEB | ? |

> 적국의 내부 연구자료 공유 시스템에 접근하였다.
> 관리자 키를 이용하여 치료제 정보를 탈취하라.

---

## 풀이 절차

1. 주석으로 숨겨진 `vaccine.php` 확인
2. upload시 태그를 이용하여 내서버의 xs-leak 스타일을 적용
3. `paper.php`에 적용된 CSP의 `style-src`와 `font-src`가 `*`임을 이용하여 **font-face를 이용한 xs-leak 공격**
4. 내 서버로 전송된 문자들을 정렬하여 `vaccine.php`에 전송

---

## 취약점

### CSP 정책

```
style-src: *
font-src: *
```

CSP에서 font-src가 `*`로 설정되어 있어 외부 font를 로드할 수 있음

### XS-Leak with Font-Face

font-face의 `unicode-range`를 이용하여 특정 문자가 페이지에 존재하는지 leak 가능

---

## Flag

```
flag{Y0u_5uCc3sfu11y_7R4CK_adM1n_4nd_G3t_Vaccine}
```
